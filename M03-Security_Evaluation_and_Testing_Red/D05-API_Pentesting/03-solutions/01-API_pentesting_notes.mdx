# TA Brief: Penetration Testing IBC’s News Platform REST API

Welcome to the API security testing session! As the Teaching Assistant, your role is to guide students as they examine and assess IBC’s news platform REST API for security flaws. Today’s focus is on identifying, understanding, and proposing solutions for common API vulnerabilities.

## Overview and Objectives

**Module:** Advanced API Penetration Testing  
**Focus:** Identifying and Exploiting Common API Vulnerabilities in IBC’s News Platform

### Learning Objectives

- **Vulnerability Recognition in APIs:**  
  Help students discover a broad range of API-specific flaws, such as Broken Access Control, Insufficient Authorization, Data Exposure, and Injection vulnerabilities in REST endpoints.

- **Impact Assessment on API Resources:**  
  Encourage students to consider how exploited vulnerabilities could affect data integrity, confidentiality, and the trustworthiness of the published news content.

- **Remediation and Industry Standards:**  
  Guide students in recommending best practice solutions, including proper authentication mechanisms, secure session tokens, strict access controls, and robust input validation.

## Daily Schedule

- **13:30 - 13:45: Introduction to API Pentest Exercise**

  - Briefly recap the scenario: They are testing a REST API for IBC’s news platform.
  - Emphasize the OWASP API Security Top 10 and common API attack vectors.

- **13:45 - 16:00: Vulnerability Discovery & Analysis**

  - Students use tools like Postman, curl, or Burp Suite’s REST features.
  - They should look for missing authentication on endpoints, incorrect role-based access control, sensitive data leaks, injection points in query parameters or JSON payloads, and error messages that reveal too much information.

- **16:00 - 16:10: Break**

- **16:10 - 17:30: Documenting Findings & Proposing Solutions**

  - Students create a structured report of their findings.
  - They detail vulnerabilities, their impact on content integrity or user data privacy, and propose actionable remediation steps.

- **17:30 - 17:45: Q&A, Group Discussion, and Feedback**

  - Encourage students to share their discoveries, highlight tricky vulnerabilities, and compare solution approaches.
  - Discuss how API-specific mitigations (rate limiting, proper HTTP methods usage, strict input schemas) differ from traditional web app security.

- **17:45 - 18:00: Daily Recap and Closing**
  - Summarize the day’s key insights.
  - Provide an overview of next steps, encouraging them to explore advanced testing methods or integrate security checks into CI/CD pipelines.
  - Remind students to review course materials before the next session.

## TA Responsibilities

### During Vulnerability Discovery

1. **Prompt Comprehensive Testing of the API:**

   - If students focus only on one endpoint, encourage them to explore other routes: content creation, draft vs. published articles, user comment endpoints.
   - Suggest they try unauthorized requests (no token or cookie), manipulate tokens, or modify user roles in requests to test access controls.

2. **Encourage Methodical Input Testing:**

   - Have them vary request methods (GET, POST, DELETE) where possible.
   - Propose adding special characters or large inputs to fields that might cause SQLi, XSS (in comments), or JSON injection.
   - Remind them to consider business logic flaws: Can a reader access journalist-only endpoints?

3. **Highlight Realistic Attack Scenarios:**
   - Ask how an attacker might chain flaws: an authentication bypass followed by data extraction or the insertion of malicious articles or comments.

### During Documentation and Remediation Phase

- **Clarify Technical Concepts:**  
  If a student struggles with the concept of rate limiting or bearer token misuse, explain their real-world implications. For instance, no rate limiting could allow brute-force attacks on login endpoints.

- **Promote API Security Best Practices:**  
  Encourage specific solutions:

  - Enforcing strict authentication **(OAuth 2.0, short-lived JWTs)**.
  - Implementing role-based authorization checks on every endpoint.
  - Applying input validation on request bodies (JSON schemas) to prevent injection.
  - Using secure response headers and structured error messages to avoid leaking internal details.

- **Review Report Quality:**  
  Ensure vulnerabilities are well-documented with clear reproduction steps and that proposed fixes are actionable and align with industry standards (OWASP API Security guidelines).

### General Support

- **Monitor Progress:**  
  Identify students who appear confused by API testing workflows and offer hints: show them how to intercept requests or how to view JSON responses for hidden fields.

- **Foster Collaboration:**  
  Encourage students to compare findings—if one group discovered a sensitive data leak in an article endpoint, have them discuss that method with others.

- **Answer Questions Authoritatively but Accessibly:**  
  Provide references (OWASP API Security Top 10) and analogies where needed. Avoid overly complex jargon.

## Common Issues and Solutions

- **Not Finding Role-Based Access Issues:**  
  Remind students to remove or modify tokens and see if the endpoint still responds with sensitive data.

- **Difficulty Understanding Data Exposure Impact:**  
  Have them consider how leaked journalist details or unpublished articles could damage IBC’s credibility.

- **Vague or Generic Remediation Advice:**  
  Push them to specify exact methods: “Use JSON schema validation for request bodies,” or “Implement RBAC checks so that only journalists can modify content.”

## Additional Tips

- **Highlight Professional Relevance:**  
  Remind students that API security is a cornerstone of modern web services. Skills in API testing are highly valued in real-world cybersecurity roles.

- **Time Management:**  
  Nudge students to keep moving if stuck. Encourage them to skip an endpoint and return after exploring others.

- **Reward Curiosity and Thoroughness:**  
  Praise students who try unconventional endpoints or pay attention to subtle JSON fields or hidden query parameters.

By following this brief, you’ll help students develop a solid understanding of API-specific vulnerabilities, their implications, and the best practices for securing REST endpoints. They will gain confidence in applying these techniques in professional environments.

---

# Solution: API Security

## Level 1: Broken Function Level Authorization

The challenge description:

As described, we need to find some hidden path within the app that has broken function level authorization; therefore, we can access it without any authorization mechanism. One of the common ways to do that is to look for hidden administrative interfaces.

As the app is based on an AngularJS application, I decided to take a look at the bundle.js, which contains all the JavaScript hardcoded logic and paths:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Finding the Hidden Application Path in Code

With Burp Suite, I tried to access the path directly, and I got our first flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_1.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Getting admin path first flag

## Level 2: Broken Object Level Authorization (BOLA)

The challenge description:

In BOLA, we need to identify an API method that does not implement any access control check. It usually does happen with API methods that accept user input in their query string or path variables (for example: `/users/<id>/info`).

As part of the CTF, we were given the API documentation (as Swagger and Postman), so I decided to have a look at the Postman first, and I found the following API method:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_2.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Based on this method, we need to provide the article slug (aka "name"). Let's view one of the articles:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_3.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Great! Let's take that slug and send it to our API endpoint to get our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_4.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 3: Broken User Authentication

The challenge description:

So I decided to start with basic OSINT, read the post in the application, and see if anything came up. As I'm pokeing around, I found that Pikachu has several positions with his email address and some list of other Pokémon's colleagues, I guess?

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_5.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Pikachu's list of friends

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_6.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Pikachu email

The idea that comes up to my mind is that: Maybe we can use brute force attack as part of the Broken User Authentication issues, as no other Pokémon has his email published... and also we got a decent amount of possible passwords.

So I used the Burp Suite Intruder feature to load all those Pokémons as passwords while using Pikachu's email address:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_7.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

And finally, we got our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_8.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

It seems that Pikachu like Snorlax very much : )

## Level 4: Improper API Management

The challenge description:

The first thing that I thought in terms of this vulnerability is to automate a discovery process for every account in that system and see if any API endpoint leaks any excessive data.
I used Burp Suite agin to automate the process for the GET profiles method as the first try:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_9.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Then, it was found that Rocket Team has some credit cards exposed (ironecly right?):

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_10.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Let's try to use their card as Pikachu as sweet revenge to buy a membership... and we've got our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_11.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 5: Improper Assets Management

The challenge description:

Like in real life, developers are using version controls to track their API development when new features are coming out or deployed to production. So I decided to take the only API endpoint that I found with version control -- the login API:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_12.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

By modifying the version from 2 to 1 I would expect that the API endpoint will have some hidden gem... and I was right, the old API endpoint contains our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_13.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 6: Lack of Resources and Rate Limiting

The challenge description:

In API security, there are two ways to make the API webserver consume more resources and lead to a lack of resources or denial of service (DoS); the first is to create a large number of requests or send multiple requests exceed the API server rate limit.

I decided to try to abuse the API web server rate limit; the problem was finding an entry point. After poking around, I discovered that the Articles API endpoint was limited to fetching every ten records from the database. So... what would happen if I attempt to ask for more documents from the database but in a large volume? Let's try!

So I modified the limit value from "10":

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_14.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

To "10000," which probably causes to database error and to fetch our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_15.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 7: Insufficient Logging

The challenge description:

Based on the challenge description, we must find a way to abuse the application's logging mechanism. The problem is that we don't know what the endpoint is. The application doesn't seem to send any logging API request, as well as no documentation in Swagger or Postman.

So back to the basics, we already know that the application has some hardcoded paths within its JavaScript bundle.js file, so let's find it:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_16.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Great! Now let's use Burp Suite to send a request to this API endpoint. I decided to try the GET HTTP method, and it seto work:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_17.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 8: Mass Assignment

The challenge description:

Mass Assignment vulnerability is caused whenever the webserver assigns fields or server parameters based on the client request. Let's try to simplify the concept with a basic example:
Assume we have a login page with the following HTML code:

```html
<form> <input name="username" type="text"> <input name="password" type="text"> <input type="submit"> </form>
```

But the backend has these parameters: username, password, and isAdmin. As we can see, the client code does not mention theisAdmin parameter in the HTML form. But! If we somehow know that this field exists, we can add it to our request as the isAdmin field, which causes the web server to process the field value as well though it wasn't in the original form.

In our application, we can see in the login response that the user object has the isAdmin attribute:

![img_18.png](img_18.png)

Now let's add this field to our client request; the web server will process that field and get us the flag:

![img_19.png](img_19.png)

## Level 9: Injection

The challenge description:

We need to find an entry point for some injection (might be SQL, XSS, NoSQL, etc.). After looking at the API documentation for research, I found that the documentation of Swagger and Postman was slightly different.
Looking at the Postman, nothing came up:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_20.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

However, in the Swagger, there's an additional method called "debug," which accepts commands:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_21.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Interesting! Heading to Burp Suite to play around with that API method, we could see that only one command is supported:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_22.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Let's run the uptime command:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_23.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

Okay, let's try to use that command as an entry point for command injection, and we got our shiny flag!

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_24.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

## Level 10: Security Misconfiguration

The challenge description:

Cool! Now we need to find a misconfiguration in the API infrastructure. It may be an open port, exposed header, outdated web server, etc. As I've been playing around with the app already, I couldn't find any application-type of misconfiguration, so I decided to try with classic open ports stuff.
When I just installed the docker, I remembered it showed me that the Redis database had been installed, so let's give it a shot!

I downloaded the Redis GUI (free) and tried to connect to the local Redis server BUT without a username and password at first:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_25.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />

So I got access as anonymous to the database! That's a classic misconfiguration. Now all left is to clear our flag:

<img src='https://cyber-lead-assets.s3.amazonaws.com/M03-Security_Evaluation_and_Testing_Red/D05-API_Pentesting/03-solutions/img_26.png' style={{ width: '100%', maxWidth: '500px', margin: '0 auto' }} />
