# Advanced Penetration Testing Techniques

## What you will learn in this course üßêüßê

- Let's explore advanced web penetration testing techniques!

You have likely already had the opportunity to learn and test various fundamental web attack techniques. These techniques are important for gaining a comprehensive understanding of the subject and can still, in some cases, work on real web applications today. However, it's time to move on to more serious matters and delve into much more advanced techniques. We will explore the following key techniques:

1. **File Upload Bypass**: This vulnerability occurs when an attacker is able to bypass restrictions on file uploads, allowing them to upload malicious files such as web shells, which can then be executed on the server. Improper validation of file types, extensions, and content can lead to severe security breaches.

2. **Cross-Origin Resource Sharing (CORS) Vulnerabilities**: CORS is a security feature that controls how web resources are shared across different origins. However, misconfigurations in CORS policies can allow unauthorized cross-origin access, leading to data theft, unauthorized actions on behalf of users, and other malicious activities.

3. **Command Injection**: This occurs when an attacker can execute arbitrary commands on the host operating system via a vulnerable application. This is often due to insufficient validation or sanitization of user inputs that are passed to system-level commands.

4. **Carriage Return Line Feed (CRLF) Injection**: CRLF injection exploits vulnerabilities in web applications by injecting CRLF characters into HTTP headers. This can lead to a variety of attacks, including HTTP response splitting, which can be used for cross-site scripting (XSS) and other malicious purposes.

5. **Cross-Site Request Forgery (CSRF)**: CSRF vulnerabilities allow attackers to perform unauthorized actions on behalf of a user without their consent. By tricking users into submitting malicious requests, attackers can manipulate web applications and gain access to sensitive data.

6. **Clickjacking**: Clickjacking is a UI redress attack where a user is tricked into clicking on something different from what the user perceives, potentially leading to unauthorized actions or disclosure of sensitive information. It often involves layering malicious content over legitimate buttons or links.

## Gaining and Escaping a Shell

During a penetration test, successfully exploiting certain vulnerabilities, such as File Upload Bypass or Command Injection might allow you to gain a shell on the target system. However, the initial shell is often limited in functionality, offering restricted access or an awkward interface. To fully exploit the system and achieve greater control, you may need to "escape" this shell to gain a more robust, interactive environment. Here are some techniques to achieve this:

1. **Upgrading to a TTY Shell**: If the initial shell is a basic, non-interactive shell, you can often upgrade it to a TTY (teletypewriter) shell for better command execution and control. This can be done using Python:

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

Or via other methods such as Perl:

```bash
perl -e 'exec "/bin/bash";'
```

2. **Using `script` Command**: You can use the `script` command to create a new TTY session:

```bash
script /dev/null -c bash
```

**Escaping Restricted Shells**: In cases where the shell is restricted (e.g., rbash or a jailed environment), techniques such as spawning a new shell, escaping via vi or other editors, or exploiting misconfigured environment variables can be used to break out of the restricted environment.
